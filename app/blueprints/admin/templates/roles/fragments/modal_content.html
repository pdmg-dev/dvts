<div class="modal-header">
  {% if action == "delete" %}
    <h1 class="modal-title fs-5">Remove role</h1>
  {% else %}
    <h1 class="modal-title fs-5">{% if action == "update" %}Edit role{% else %}New role{% endif %}</h1>
  {% endif %}
  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
</div>

<div class="modal-body">
  {% if action == "delete" %}
    <form
      hx-post="{{ url_for('admin.role_delete_post', role_id=role.id) }} "
      hx-target="#modalContent"
      hx-swap="innerHTML"
    >
      <p class="m-0">Are you sure you want to delete <strong>{{ role.name }}</strong>?</p>
    </form>
  {% else %}
    <form
      id="roleForm"
      hx-post="{% if action == 'update' %}
        {{ url_for('admin.role_update_post', role_id=role_id) }}
      {% else %}
        {{ url_for('admin.role_create_post') }}
      {% endif %}"
      hx-target="#modalContent"
      hx-swap="innerHTML"
      novalidate
    >
      {{ form.hidden_tag() }}

      {% if action == "create" %}
        <label for="roleNameInput" class="form-label form-label-sm">Please enter a new role name.</label>
      {% else %}
        <label for="roleNameInput" class="form-label form-label-sm">Role name:</label>
      {% endif %}

      {{ form.name(class="form-control " ~ ('is-invalid' if form.name.errors else ''), id="roleNameInput") }}

      {% for error in form.name.errors %}
        <div class="invalid-feedback">{{ error }}</div>
      {% endfor %}
    </form>

    <script>
      document.getElementById("adminModal")?.addEventListener("shown.bs.modal", function () {
        const input = document.querySelector("#roleNameInput");
        if (input) {
          // Move cursor to the end of the input value
          input.focus();
          const length = input.value.length;
          input.setSelectionRange(length, length);
        }
      });
    </script>
  {% endif %}
</div>

<div class="modal-footer">
  <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
  {% if action == "delete" %}
    <button
      type="button"
      class="btn btn-danger"
      hx-post="{{ url_for('admin.role_delete_post', role_id=role.id) }}"
      hx-target="#modalContent"
      hx-swap="innerHTML"
    >
      Delete
    </button>
  {% else %}
    <button type="submit" class="btn btn-primary" form="roleForm" id="modalActionBtn">
      {% if action == "update" %}Save{% else %}Create{% endif %}
    </button>
  {% endif %}
</div>
